#!/bin/bash

export NIRI_SOCKET=${NIRI_SOCKET:-$(find "$XDG_RUNTIME_DIR" -maxdepth 1 -name 'niri.*' -print -quit)}

theme_kind=$(darkman get)

echo "Switching to $theme_kind mode"

if [ "$theme_kind" = "light" ]
then
    theme_display_name='Rosé Pine Dawn'
    theme_kebab_name=rose-pine-dawn
else
    theme_display_name='Rosé Pine'
    theme_kebab_name=rose-pine
fi

kitten themes --cache-age=-1 --config-file-name=themes.conf --reload-in=all "$theme_display_name"

echo "include \"$theme_kebab_name\"" > ~/.config/micro/colorschemes/current.micro

echo "@import \"$theme_kebab_name.css\";" > ~/.config/waybar/colours.css
killall waybar
niri msg action spawn -- waybar

~/bin/switch-wallpaper
